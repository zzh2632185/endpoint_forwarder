# Claude Request Forwarder Configuration
# å®Œæ•´é…ç½®ç¤ºä¾‹ï¼Œå±•ç¤ºæ‰€æœ‰å¯ç”¨çš„é…ç½®é€‰é¡¹

# æœåŠ¡å™¨é…ç½®
server:
  host: "127.0.0.1"      # ç›‘å¬åœ°å€ï¼Œé»˜è®¤: localhost
  port: 8087             # ç›‘å¬ç«¯å£ï¼Œé»˜è®¤: 8080

# è·¯ç”±ç­–ç•¥é…ç½®(é€‚ç”¨äºç»„å†…)
strategy:
  type: "fastest"                  # è·¯ç”±ç­–ç•¥: "priority" (ä¼˜å…ˆçº§) æˆ– "fastest" (æœ€å¿«å“åº”)
  fast_test_enabled: true          # å¯ç”¨å¿«é€Ÿæµ‹è¯• (ä»…åœ¨ fastest ç­–ç•¥ä¸‹ç”Ÿæ•ˆ)
  fast_test_cache_ttl: "30s"       # å¿«é€Ÿæµ‹è¯•ç»“æœç¼“å­˜æ—¶é—´ï¼Œé»˜è®¤: 3s
  fast_test_timeout: "5s"          # å¿«é€Ÿæµ‹è¯•è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤: 1s  
  fast_test_path: "/v1/models"     # å¿«é€Ÿæµ‹è¯•è·¯å¾„ï¼Œé»˜è®¤ä½¿ç”¨å¥åº·æ£€æŸ¥è·¯å¾„

# é‡è¯•é…ç½®
retry:
  max_attempts: 3        # æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤: 3
  base_delay: "1s"       # åŸºç¡€å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤: 1s
  max_delay: "30s"       # æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤: 30s
  multiplier: 2.0        # å»¶è¿Ÿå€æ•°ï¼Œé»˜è®¤: 2.0

# å¥åº·æ£€æŸ¥é…ç½®
health:
  check_interval: "30s"  # å¥åº·æ£€æŸ¥é—´éš”ï¼Œé»˜è®¤: 30s
  timeout: "5s"          # å¥åº·æ£€æŸ¥è¶…æ—¶ï¼Œé»˜è®¤: 5s
  health_path: "/v1/models"  # å¥åº·æ£€æŸ¥è·¯å¾„ï¼Œé»˜è®¤: /v1/models

# æ—¥å¿—é…ç½®
logging:
  level: "info"          # æ—¥å¿—çº§åˆ«: debug, info, warn, errorï¼Œé»˜è®¤: info
  format: "json"         # æ—¥å¿—æ ¼å¼: "json" æˆ– "text"ï¼Œé»˜è®¤: text
  
  # æ–‡ä»¶æ—¥å¿—é…ç½® (å¯é€‰)
  file_enabled: false            # æ˜¯å¦å¯ç”¨æ–‡ä»¶æ—¥å¿—ï¼Œé»˜è®¤: false
  file_path: "logs/app.log"      # æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤: logs/app.log
  max_file_size: "100MB"         # å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œæ”¯æŒ: KB, MB, GBï¼Œé»˜è®¤: 100MB
  max_files: 10                  # æœ€å¤šä¿ç•™çš„è½®è½¬æ–‡ä»¶æ•°é‡ï¼Œé»˜è®¤: 10
  compress_rotated: true         # æ˜¯å¦å‹ç¼©è½®è½¬çš„æ—§æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤: false
  disable_response_limit: true   # å¯ç”¨æ–‡ä»¶æ—¥å¿—æ—¶æ˜¯å¦å–æ¶ˆå“åº”å†…å®¹è¾“å‡ºé™åˆ¶ï¼Œé»˜è®¤: false

# æµå¼ä¼ è¾“é…ç½®
streaming:
  heartbeat_interval: "30s"  # å¿ƒè·³é—´éš”ï¼Œé»˜è®¤: 30s
  read_timeout: "10s"         # è¯»å–è¶…æ—¶ï¼Œé»˜è®¤: 1s
  max_idle_time: "120s"      # æœ€å¤§ç©ºé—²æ—¶é—´ï¼Œé»˜è®¤: 120s

# ç»„ç®¡ç†é…ç½®
group:
  cooldown: "600s"           # ç»„å¤±è´¥åçš„å†·å´æ—¶é—´ï¼Œé»˜è®¤: 600s
  max_retries: 3             # ç»„æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œè¶…è¿‡åè¿›å…¥å†·å´ï¼Œé»˜è®¤: 3

# å…¨å±€è¶…æ—¶é…ç½®
global_timeout: "300s"       # éæµå¼è¯·æ±‚çš„å…¨å±€é»˜è®¤è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤: 300s (5åˆ†é’Ÿ)

# é‰´æƒé…ç½® (å¯é€‰)
auth:
  enabled: false             # æ˜¯å¦å¯ç”¨é‰´æƒï¼Œé»˜è®¤: false (ä¸é‰´æƒ)
  # token: "your-bearer-token"  # Bearer Tokenï¼Œå¯ç”¨é‰´æƒæ—¶å¿…é¡»è®¾ç½®

# TUIç•Œé¢é…ç½®,å¦‚æœéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šå»ºè®®è®¾ç½®ä¸º false
tui:
  enabled: true               # æ˜¯å¦å¯ç”¨TUIç•Œé¢ï¼Œé»˜è®¤: true
  update_interval: "1s"       # TUIåˆ·æ–°é—´éš”ï¼Œé»˜è®¤: 1s
  save_priority_edits: false  # æ˜¯å¦åœ¨TUIä¸­ä¿å­˜ä¼˜å…ˆçº§ç¼–è¾‘åˆ°é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤: falseï¼ˆå½“å‰æƒ…å†µä¸‹ä¿å­˜é…ç½®æ–‡ä»¶å¯èƒ½ä¼šè‡ªåŠ¨æ ¼å¼åŒ–é…ç½®æ–‡ä»¶ï¼‰

# ä»£ç†é…ç½® (å¯é€‰)
proxy:
  enabled: false              # æ˜¯å¦å¯ç”¨ä»£ç†
  type: "http"               # ä»£ç†ç±»å‹: "http", "https", æˆ– "socks5"
  
  # æ–¹å¼ä¸€: å®Œæ•´ä»£ç† URL
  # url: "http://proxy.example.com:8080"
  # url: "https://proxy.example.com:8080"
  # url: "socks5://proxy.example.com:1080"
  
  # æ–¹å¼äºŒ: åˆ†åˆ«æŒ‡å®šä¸»æœºå’Œç«¯å£
  host: "proxy.example.com"   # ä»£ç†ä¸»æœº
  port: 8080                  # ä»£ç†ç«¯å£
  
  # å¯é€‰çš„è®¤è¯ä¿¡æ¯
  # username: "proxy_user"    # ä»£ç†ç”¨æˆ·å
  # password: "proxy_pass"    # ä»£ç†å¯†ç 

# ç«¯ç‚¹é…ç½®
# ==================== ç»„å¯†é’¥é…ç½®è¯´æ˜ ====================
# æ¯ä¸ªç»„çš„ç¬¬ä¸€ä¸ªç«¯ç‚¹åº”è¯¥å®šä¹‰è¯¥ç»„ä½¿ç”¨çš„ token å’Œ api-key
# ç»„å†…å…¶ä»–ç«¯ç‚¹å¦‚æœæ²¡æœ‰å®šä¹‰ token/api-keyï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ç»„å†…ç¬¬ä¸€ä¸ªç«¯ç‚¹çš„å¯†é’¥
# å¦‚æœæŸä¸ªç«¯ç‚¹éœ€è¦ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå¯ä»¥æ˜¾å¼æŒ‡å®š token/api-key æ¥è¦†ç›–ç»„é»˜è®¤å€¼
# ========================================================

endpoints:
  # ============ ä¸»è¦ç»„ (main) ============
  # ç»„å®šä¹‰ç«¯ç‚¹ - å®šä¹‰æ•´ä¸ª main ç»„ä½¿ç”¨çš„å¯†é’¥
  - name: "primary"
    url: "https://api.openai.com"
    group: "main"                          # ç»„å
    group-priority: 1                      # ç»„ä¼˜å…ˆçº§ (æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜)
    priority: 1                            # ç»„å†…ä¼˜å…ˆçº§ (æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜)
    timeout: "300s"
    token: "sk-your-openai-api-key"        # ğŸ”‘ æ­¤å¯†é’¥ä¼šè¢«åŒç»„å…¶ä»–ç«¯ç‚¹å…±äº«
    api-key: "your-api-key-value"          # ğŸ”‘ æ­¤APIå¯†é’¥ä¼šè¢«åŒç»„å…¶ä»–ç«¯ç‚¹å…±äº«
    headers:
      User-Agent: "Claude-Request-Forwarder/1.0"
      X-Custom-Header: "custom-value"

  # ä¸»è¦ç»„å¤‡ç”¨ç«¯ç‚¹ - è‡ªåŠ¨ä½¿ç”¨ main ç»„çš„å¯†é’¥
  - name: "primary_backup"
    url: "https://api.anthropic.com"
    priority: 2                            # ç»„å†…ä¼˜å…ˆçº§ 2
    timeout: "300s"
    # ğŸ”„ è‡ªåŠ¨ç»§æ‰¿: group: "main", group-priority: 1
    # ğŸ”‘ è‡ªåŠ¨ä½¿ç”¨ main ç»„çš„å¯†é’¥: token å’Œ api-key ä¼šåŠ¨æ€è§£æä¸º primary ç«¯ç‚¹çš„å€¼
    # ğŸ“‹ headers ç»§æ‰¿è‡ª primary ç«¯ç‚¹

  # ============ å¤‡ç”¨ç»„ (backup) ============
  # ç»„å®šä¹‰ç«¯ç‚¹ - å®šä¹‰æ•´ä¸ª backup ç»„ä½¿ç”¨çš„å¯†é’¥
  - name: "backup1"
    url: "https://api.example.com"
    group: "backup"                        # æ–°çš„ç»„å
    group-priority: 2                      # å¤‡ç”¨ç»„ä¼˜å…ˆçº§
    priority: 1                            # ç»„å†…ä¼˜å…ˆçº§
    timeout: "300s"
    token: "sk-backup-group-api-key"       # ğŸ”‘ æ­¤å¯†é’¥ä¼šè¢«åŒç»„å…¶ä»–ç«¯ç‚¹å…±äº«
    api-key: "backup-group-api-key"        # ğŸ”‘ æ­¤APIå¯†é’¥ä¼šè¢«åŒç»„å…¶ä»–ç«¯ç‚¹å…±äº«
    headers:
      Authorization: "Bearer custom-token"
      X-API-Version: "2024-01"

  # å¤‡ç”¨ç»„çš„ç¬¬äºŒä¸ªç«¯ç‚¹ - è‡ªåŠ¨ä½¿ç”¨ backup ç»„çš„å¯†é’¥
  - name: "backup2"
    url: "https://api.backup2.com"
    priority: 2                            # ç»„å†…ä¼˜å…ˆçº§ 2
    timeout: "300s"
    # ğŸ”„ è‡ªåŠ¨ç»§æ‰¿: group: "backup", group-priority: 2
    # ğŸ”‘ è‡ªåŠ¨ä½¿ç”¨ backup ç»„çš„å¯†é’¥: ä¼šåŠ¨æ€è§£æä¸º backup1 ç«¯ç‚¹çš„å¯†é’¥

  # å¤‡ç”¨ç»„çš„ç¬¬ä¸‰ä¸ªç«¯ç‚¹ - ä½¿ç”¨è‡ªå®šä¹‰å¯†é’¥è¦†ç›–ç»„é»˜è®¤å€¼
  - name: "backup3"
    url: "https://api.backup3.com"
    priority: 3                            # ç»„å†…ä¼˜å…ˆçº§ 3
    timeout: "300s"
    token: "sk-custom-override-key"        # ğŸ”‘ è¦†ç›–ç»„é»˜è®¤å¯†é’¥ï¼Œåªæœ‰è¿™ä¸ªç«¯ç‚¹ä½¿ç”¨æ­¤å¯†é’¥
    # ğŸ”„ group å’Œ group-priority ä»ç„¶ç»§æ‰¿è‡ª backup ç»„
    # ğŸ”‘ api-key ä»ç„¶ä½¿ç”¨ç»„é»˜è®¤å€¼ (backup1 çš„ api-key)

  # ============ æœ¬åœ°ç»„ (local) ============
  # æœ¬åœ°æœåŠ¡ç»„ - é€šå¸¸ä¸éœ€è¦å¯†é’¥
  - name: "local"
    url: "http://localhost:11434"
    group: "local"                         # æœ¬åœ°ç»„
    group-priority: 3                      # æœ€ä½ç»„ä¼˜å…ˆçº§
    priority: 1                            # ç»„å†…ä¼˜å…ˆçº§
    timeout: "300s"
    # ğŸ”“ æœ¬åœ°æœåŠ¡é€šå¸¸ä¸éœ€è¦ token å’Œ api-key

  # æœ¬åœ°ç»„å¤‡ç”¨ç«¯ç‚¹
  - name: "local_backup"
    url: "http://localhost:8080"
    priority: 2                            # ç»„å†…ä¼˜å…ˆçº§ 2
    timeout: "300s"
    # ğŸ”„ è‡ªåŠ¨ç»§æ‰¿: group: "local", group-priority: 3
    # ğŸ”“ æ— å¯†é’¥é…ç½®ï¼Œé€‚ç”¨äºæœ¬åœ°æœåŠ¡